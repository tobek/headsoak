$link-opacity: 0.5 // default link opacity
$link-opacity--crowded: $link-opacity * 0.5 // links on crowded (force-graph gets .is--crowded) graphs
$link-opacity--connected: 0.75
$hover-fade-factor: 0.25 // multiply opacity by this when a node is being hovered (force-graph gets .is--node-hovered) and this element is not connected (not .is--connected)
$size1-fade-factor: 0.5 // some things (currently: nodes and links of size/weight 1) are faded even more on crowded (force-graph gets .is--crowded) graphs


force-graph
  display: block
  position: relative

  svg
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%

  .link
    stroke: #999
    stroke-opacity: $link-opacity

  .node
    circle
      fill: $secondary-color
      stroke: $secondary-color
      stroke-width: 1px
      transition: fill $transition-fast, stroke $transition-med, stroke-width $transition-med

    &:hover
      circle
        fill: $highlight-color
        stroke: $highlight-color

    &.is--fixed,
    &.is--fixed:hover
      circle
        // @TODO/visualization @TODO/ece What do you think of this?
        transition: fill $transition-fast, stroke $transition-slow ease-in-out, stroke-width $transition-slow ease-in-out
        stroke: fade-out($secondary-color, 0.5)
        stroke-width: 10px

    &.is--prog
      circle,
      &:hover circle
        fill: $primary-color-light
        
      &:hover circle
        stroke: $highlight-color

      &.is--fixed circle
        stroke-width: 5px


  text
    +small
    cursor: default
    user-select: none
    text-shadow: white 1px 1px 2px

  .is--text-centered text
    text-shadow: none

  .node:hover text
    font-weight: bold


  .node,
  .link,
  text
    transition: fill-opacity $transition-med, stroke-opacity $transition-med

  &.is--node-hovered
    .node,
    text
      fill-opacity: $hover-fade-factor
      stroke-opacity: $hover-fade-factor

    .link
      stroke-opacity: $link-opacity * $hover-fade-factor

  &.is--crowded
    .link
      stroke-opacity: $link-opacity--crowded
      &.size1
        stroke-opacity: $link-opacity--crowded * $size1-fade-factor

    text.size1
      fill-opacity: $size1-fade-factor

  &.is--crowded.is--node-hovered
    .link
      stroke-opacity: $link-opacity--crowded * $hover-fade-factor

    text.size1
      fill-opacity: $size1-fade-factor * $hover-fade-factor

  // Unfaded for connected stuff on hover
  &.is--node-hovered
    .node.is--connected
      fill-opacity: 1 !important
      stroke-opacity: 1 !important
      text
        fill-opacity: 1 !important
    .link.is--connected
      stroke-opacity: $link-opacity--connected !important
    .node:hover text
      transition: fill-opacity $transition-fast
      fill-opacity: 1 !important


tag-visualization
  display: block
  
  .description
    +small
    z-index: 1
    position: absolute
    width: 100%
    left: 0
    bottom: 0
    padding: 0 $pane-horizontal-padding 0
    background: rgba(255,255,255,0.9)

    p
      margin: 0.8rem 0
